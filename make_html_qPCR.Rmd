---
title: "WW1_Baylor-Spike-in pilot"
author: "Prashant Kalvapalle"
date: "1 June 2020"
output: 
  html_document:
    theme: flatly
    toc: TRUE
    toc_float: TRUE
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = F, message = F, warning = F, fig.width = 8, fig.height = 4)
```

## Goal of the analysis

We want to test the efficiency of viral RNA recovery from wastewater by spiking in known ammounts of bovine viruses and quantifying by qPCR. 

## Running source codes

```{r cars}
source('general_functions.R')
source('analysis.R')
```

## Normalized recovery calculations

```{r calculations}
proc_data <- read_sheet('https://docs.google.com/spreadsheets/d/19oRiRcRVS23W3HqRKjhMutJKC2lFOpNK8aNUkC-No-s/edit#gid=1386677460', sheet = 'RT-qPCR results', range = 'C3:I93')
proc_data %>% separate(`Tube ID`, C(`Tube ID`, 'Biological replicate')) %>% rename('Copy #' = `Copy # (mean)`) # merge biological replicates
proc_summary %>% proc_data  %>% group_by(Target, `Sample Name`, `Tube ID`) %>% summarise_at(vars(`Copy #`), funs(mean(.,na.rm = T), sd)) # Summarize mean and SD


plt1 <- proc_data %>% ggplot(aes(x = `Tube ID`, y = `Recovered (copies/l)`, colour = Target)) + ylab('Copy #')
```
