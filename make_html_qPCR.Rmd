---
title: "S03 Arabinose titration qPCR"
author: "Prashant Kalvapalle"
date: "9 Oct 2019"
output: html_document
---

```{r setup, include=FALSE}
library(knitr)
knitr::opts_chunk$set(echo = F, message = F, warning = F)
```

## Goal of the analysis

We want to test by qPCR if AHL is flipping any constructs. Using this file to normalize copy #s to that of the Backbone

## Running source codes

```{r cars}
source('general_functions.R')
source('analysis.R')
```

## Fitting results

Results from fitting hill function - K~d~ (EC~50~), max , min and fold change = $\frac{max}{min}$

```{r hill_table1}
h1 <- coef(hill_param); min1 <- reporter_set %>% pull(hill_fit) %>% min()
h2 <- coef(hill_plate); min2 <- plate_subset %>% pull(GFP.fit) %>% min()

# formatting for easy read:
hill_params_table <- tibble('qPCR' = c(h1, min1, h1[1]/min1), 'GFP' = c(h2, min2, h2[1]/min2)) %>% t() %>% as_tibble() %>% mutate(Method = c('qPCR', 'GFP')) %>% select(Method, everything())
colnames(hill_params_table) <- c('Detection method', 'Maximum', 'Hill coef','EC50', 'Minimum', 'Fold change')
hill_params_table %<>% mutate_at(vars(c(3,4,6)), format, digits = 2) %>% mutate_at(vars(c(2,5)), format, digits = 2, scientific = T)

kable(hill_params_table, caption = 'Hill function fitting parameters')
```

* Considering Glucose inhibition as minimum (fold change recalculated)

```{r hill_table_glu}
glumin1 <- results_abs  %>% filter(`Sample Name` == 'Controls', assay_variable == .1) %>% pull(`Copy #`) %>% mean()
glumin2 <- plate_data  %>% filter(`[Arabinose]` == 10) %>% pull(GFP) %>% mean()

hill_params_table %<>% mutate('Glucose' = format(c(glumin1, glumin2), digits = 2, scientific = T), 'Fold over Glu' = format(c(h1[1]/glumin1, h2[1]/glumin2), digits = 2, scientific = F))

kable(hill_params_table, caption = 'Hill function fitting parameters')
```

## Data output

qPCR copy number data 

```{r datadisplay}
results_abs %<>% mutate_if(is.numeric, format, digits = 3, scientific = T)
kable(results_abs, caption = 'Summary of estimated copy #s')
```

